# План реализации - Сайт бара (MVP)

- [ ] 1. Настройка структуры проекта и базовой инфраструктуры




  - Создать структуру директорий для монорепозитория (frontend/, backend/, database/)
  - Инициализировать Go модуль для backend с Gin framework
  - Инициализировать React проект с TypeScript и PWA поддержкой
  - Создать docker-compose.yml для PostgreSQL, backend и frontend
  - Настроить Nginx конфигурацию для reverse proxy и статических файлов
  - _Требования: 10.1, 10.2_

- [ ] 2. Настройка базы данных и миграций
  - [ ] 2.1 Создать схему базы данных PostgreSQL
    - Создать таблицы: menu_items, categories, orders, order_items, bookings, events, promotions, users
    - Определить связи между таблицами (foreign keys, indexes)
    - Добавить поля для временной доступности позиций меню (available_from, available_to)
    - _Требования: 3.1, 4.1, 5.4, 9.1, 12.1, 12.3_
  
  - [ ] 2.2 Реализовать систему миграций
    - Настроить golang-migrate или аналогичный инструмент
    - Создать начальные миграции для всех таблиц
    - Добавить seed данные для тестирования
    - _Требования: 6.3_

- [ ] 3. Реализация backend API (Go)
  - [ ] 3.1 Настроить базовую структуру Go приложения
    - Создать пакеты: handlers, models, repository, middleware, utils
    - Настроить подключение к PostgreSQL через pgx или GORM
    - Реализовать базовую обработку ошибок и логирование
    - _Требования: 1.1, 6.1_
  
  - [ ] 3.2 Реализовать аутентификацию для админ-панели
    - Создать модель User с хешированием паролей (bcrypt)
    - Реализовать JWT токены для сессий
    - Создать middleware для проверки авторизации
    - Создать endpoints: POST /api/auth/login, POST /api/auth/logout
    - _Требования: 6.1, 6.2_
  
  - [ ] 3.3 Реализовать API для меню
    - Создать модель MenuItem с полями: id, name, price, weight, description, calories, category_id, image_url, available_from, available_to, is_active
    - Реализовать repository для CRUD операций с меню
    - Создать endpoints: GET /api/menu (публичный), GET /api/menu/:id, POST /api/admin/menu, PUT /api/admin/menu/:id, DELETE /api/admin/menu/:id
    - Добавить фильтрацию по времени доступности и статусу активности
    - _Требования: 1.2, 1.5, 2.2, 6.4, 9.1, 9.2, 9.3, 9.4_
  
  - [ ] 3.4 Реализовать обработку изображений
    - Интегрировать библиотеку для обработки изображений (imaging или disintegration/imaging)
    - Создать endpoint POST /api/admin/upload для загрузки фото
    - Реализовать валидацию форматов JPG, WEBP, JFIF
    - Реализовать функцию кадрирования с заданным соотношением сторон
    - Сохранять оригинал и обработанную версию изображения
    - _Требования: 6.5, 7.1, 7.2, 7.3, 7.4_
  
  - [ ] 3.5 Реализовать API для корзины и заказов
    - Создать модель Order с полями: id, items (JSON), total_amount, status, created_at
    - Создать модель OrderItem для связи заказов и позиций меню
    - Реализовать repository для работы с заказами
    - Создать endpoints: POST /api/orders (создание заказа), GET /api/admin/orders (список заказов), PUT /api/admin/orders/:id/status
    - Добавить валидацию объемов для позиций с вариантами
    - _Требования: 3.1, 3.2, 3.4, 3.5, 4.1, 4.3, 4.4, 4.5_
  
  - [ ] 3.6 Реализовать систему уведомлений для планшета бара
    - Настроить WebSocket соединение или Server-Sent Events (SSE)
    - Создать endpoint GET /api/admin/notifications/stream для подписки на уведомления
    - Отправлять уведомления при создании нового заказа
    - Отправлять уведомления при новом бронировании
    - Обеспечить доставку уведомлений в течение 3 секунд
    - _Требования: 4.2, 5.4_
  
  - [ ] 3.7 Реализовать API для бронирования столов
    - Создать модель Booking с полями: id, table_number, date, time, name, phone, guest_count, status, created_at
    - Реализовать repository для работы с бронированиями
    - Создать endpoints: POST /api/bookings, GET /api/admin/bookings, PUT /api/admin/bookings/:id/status
    - Добавить валидацию даты и времени бронирования
    - _Требования: 5.3, 5.4, 5.5_
  
  - [ ] 3.8 Реализовать API для афиши и акций
    - Создать модель Event с полями: id, title, description, event_date, event_time, image_url
    - Создать модель Promotion с полями: id, title, description, price, valid_from, valid_to, is_active
    - Реализовать repository для работы с событиями и акциями
    - Создать endpoints: GET /api/events, GET /api/promotions, POST /api/admin/events, POST /api/admin/promotions
    - Добавить фильтрацию активных акций по датам
    - _Требования: 12.1, 12.2, 12.3, 12.4_
  
  - [ ] 3.9 Реализовать импорт меню из CSV
    - Создать endpoint POST /api/admin/menu/import
    - Реализовать парсер CSV с колонками: название, цена, вес, описание, калорийность, раздел, путь к фото
    - Добавить валидацию данных и обработку ошибок
    - Возвращать список ошибок с номерами строк при некорректных данных
    - Поддержать создание и обновление существующих позиций
    - _Требования: 8.1, 8.2, 8.3, 8.4_

- [ ] 4. Реализация frontend (React + TypeScript)
  - [ ] 4.1 Настроить базовую структуру React приложения
    - Создать структуру компонентов: pages/, components/, hooks/, services/, types/
    - Настроить React Router для навигации
    - Настроить Axios или Fetch для API запросов
    - Создать базовый Layout с навигацией и переключателем темы
    - _Требования: 1.1, 11.1_
  
  - [ ] 4.2 Реализовать систему тем (светлая/темная)
    - Создать Context для управления темой
    - Реализовать переключатель темы в навигации
    - Сохранять выбор темы в localStorage
    - Применять тему ко всем компонентам через CSS variables или styled-components
    - _Требования: 11.1, 11.2, 11.3, 11.4_
  
  - [ ] 4.3 Реализовать главную страницу
    - Создать компонент HomePage с навигацией и кнопкой "Меню"
    - Отобразить афишу с ближайшими событиями
    - Выделить активные акции отдельным блоком
    - Сделать адаптивную верстку для мобильных и десктопов
    - _Требования: 1.1, 12.2, 12.4_
  
  - [ ] 4.4 Реализовать страницу меню
    - Создать компонент MenuPage с отображением всех разделов на одной странице
    - Реализовать адаптивную сетку: 1-2 колонки на мобильных, 3-4 на десктопах
    - Отобразить каждую позицию с фото, названием и ценой
    - Фильтровать позиции по времени доступности на клиенте
    - _Требования: 1.2, 1.3, 1.4, 1.5, 9.2_
  
  - [ ] 4.5 Реализовать модальное окно позиции меню
    - Создать компонент MenuItemModal с детальной информацией
    - Отобразить название, фото, описание, калорийность, цену
    - Реализовать увеличение фото при клике
    - Добавить кнопку "Добавить в корзину"
    - Добавить выбор объема для позиций с вариантами
    - Закрывать модальное окно при клике вне или на кнопку закрытия
    - _Требования: 2.1, 2.2, 2.3, 2.4, 3.1, 3.2_
  
  - [ ] 4.6 Реализовать корзину заказов
    - Создать Context для управления состоянием корзины
    - Создать компонент Cart с отображением выбранных позиций
    - Отобразить название, объем, цену каждой позиции и общую сумму
    - Реализовать изменение количества позиций с пересчетом суммы
    - Добавить кнопку "Оформить заказ"
    - Отправлять заказ на backend и показывать подтверждение
    - _Требования: 3.3, 3.4, 3.5_
  
  - [ ] 4.7 Реализовать страницу бронирования столов
    - Создать компонент BookingPage со схемой расположения 17 столов
    - Отобразить фото стола при клике на него
    - Создать форму бронирования с полями: дата, время, имя, телефон, количество человек
    - Отправлять данные бронирования на backend
    - Показывать подтверждение после успешного бронирования
    - _Требования: 5.1, 5.2, 5.3, 5.4_
  
  - [ ] 4.8 Реализовать админ-панель
    - Создать страницу входа с формой логина и пароля
    - Создать защищенные роуты для админ-панели
    - Создать дашборд с разделами: Меню, Заказы, Бронирования, Афиша, Акции
    - Реализовать навигацию между разделами админ-панели
    - _Требования: 6.1, 6.2_
  
  - [ ] 4.9 Реализовать управление меню в админ-панели
    - Создать компонент MenuManagement со списком всех позиций
    - Реализовать форму создания/редактирования позиции меню
    - Добавить поля: название, цена, вес, описание, калорийность, раздел, фотография
    - Реализовать загрузку фотографий с валидацией форматов
    - Интегрировать инструмент кадрирования изображений (react-image-crop)
    - Добавить функцию импорта из CSV файла
    - Реализовать включение/отключение позиций меню
    - Добавить настройку времени доступности позиций
    - _Требования: 6.3, 6.4, 6.5, 7.1, 7.2, 7.3, 8.1, 8.3, 9.1, 9.3, 9.4_
  
  - [ ] 4.10 Реализовать управление заказами в админ-панели
    - Создать компонент OrderManagement со списком заказов
    - Отобразить время создания, статус и детали каждого заказа
    - Реализовать просмотр деталей заказа (позиции, количество, цены)
    - Добавить возможность изменения статуса заказа
    - Интегрировать получение уведомлений о новых заказах через WebSocket/SSE
    - _Требования: 4.3, 4.4, 4.5_
  
  - [ ] 4.11 Реализовать управление бронированиями в админ-панели
    - Создать компонент BookingManagement со списком бронирований
    - Отобразить детали каждого бронирования
    - Добавить возможность изменения статуса бронирования
    - Интегрировать получение уведомлений о новых бронированиях
    - _Требования: 5.5_
  
  - [ ] 4.12 Реализовать управление афишей и акциями в админ-панели
    - Создать компонент EventManagement для управления событиями
    - Создать компонент PromotionManagement для управления акциями
    - Реализовать формы создания/редактирования событий и акций
    - Добавить загрузку изображений для событий
    - _Требования: 12.1, 12.3_

- [ ] 5. Реализация PWA и офлайн-режима
  - [ ] 5.1 Настроить Service Worker для кэширования
    - Создать service-worker.js с стратегией кэширования
    - Кэшировать статические файлы (HTML, CSS, JS)
    - Кэшировать изображения меню
    - Кэшировать API ответы для меню
    - _Требования: 10.4_
  
  - [ ] 5.2 Реализовать автоматическое переключение на локальный сервер
    - Определять доступность локального сервера при загрузке приложения
    - Переключаться на локальный API endpoint внутри бара
    - Обеспечить прозрачную работу для пользователя
    - _Требования: 10.1, 10.2_
  
  - [ ] 5.3 Настроить манифест PWA
    - Создать manifest.json с иконками и настройками
    - Добавить мета-теги для установки приложения
    - Настроить splash screen
    - _Требования: 10.4_
  
  - [ ] 5.4 Реализовать синхронизацию данных при восстановлении соединения
    - Сохранять заказы в IndexedDB при отсутствии соединения
    - Отправлять накопленные заказы при восстановлении соединения
    - Показывать статус синхронизации пользователю
    - _Требования: 10.3_

- [ ] 6. Настройка развертывания и инфраструктуры
  - [ ] 6.1 Создать Dockerfile для backend
    - Создать multi-stage Dockerfile для Go приложения
    - Оптимизировать размер образа
    - Настроить переменные окружения
    - _Требования: 10.1_
  
  - [ ] 6.2 Создать Dockerfile для frontend
    - Создать multi-stage Dockerfile с nginx для статики
    - Настроить nginx.conf для SPA роутинга
    - Оптимизировать размер образа
    - _Требования: 10.1_
  
  - [ ] 6.3 Настроить docker-compose для локального развертывания
    - Объединить PostgreSQL, backend, frontend в docker-compose.yml
    - Настроить volumes для персистентности данных
    - Настроить сети для изоляции сервисов
    - Добавить health checks
    - _Требования: 10.1, 10.2_
  
  - [ ] 6.4 Настроить SSL сертификаты
    - Создать инструкцию для получения SSL через KeenDNS
    - Создать self-signed сертификат для локальной разработки
    - Настроить nginx для HTTPS
    - _Требования: 10.1_
  
  - [ ] 6.5 Создать документацию по развертыванию
    - Написать README с инструкциями по установке
    - Документировать настройку роутера Keenetic
    - Описать процесс обновления приложения
    - Добавить troubleshooting секцию
    - _Требования: 10.1, 10.2_

- [ ] 7. Тестирование и валидация
  - [ ] 7.1 Написать unit тесты для backend
    - Создать тесты для handlers
    - Создать тесты для repository слоя
    - Создать тесты для middleware
    - _Требования: все_
  
  - [ ] 7.2 Написать integration тесты для API
    - Создать тесты для полного flow заказа
    - Создать тесты для flow бронирования
    - Создать тесты для админ-панели
    - _Требования: 3.5, 4.2, 5.4_
  
  - [ ] 7.3 Написать тесты для React компонентов
    - Создать тесты для основных компонентов (Menu, Cart, Booking)
    - Создать тесты для Context провайдеров
    - Создать тесты для hooks
    - _Требования: все_
  
  - [ ] 7.4 Провести тестирование производительности
    - Протестировать нагрузку на 50 одновременных пользователей
    - Проверить время отклика API endpoints
    - Оптимизировать медленные запросы
    - _Требования: 4.2_

- [ ] 8. Финальная интеграция и проверка
  - [ ] 8.1 Интегрировать все компоненты системы
    - Проверить работу frontend с backend API
    - Проверить работу уведомлений на планшете бара
    - Проверить работу офлайн-режима
    - _Требования: все_
  
  - [ ] 8.2 Создать тестовые данные
    - Загрузить примеры позиций меню с фотографиями
    - Создать тестовые события и акции
    - Создать тестового администратора
    - _Требования: 6.2_
  
  - [ ] 8.3 Провести end-to-end тестирование
    - Протестировать полный flow заказа от выбора до получения на планшете
    - Протестировать полный flow бронирования
    - Протестировать работу админ-панели
    - Протестировать переключение тем
    - Протестировать работу на разных устройствах (ПК, телефон, планшет)
    - _Требования: все_
  
  - [ ] 8.4 Подготовить к production развертыванию
    - Проверить все переменные окружения
    - Настроить логирование и мониторинг
    - Создать backup стратегию для базы данных
    - Подготовить инструкции для администратора
    - _Требования: 10.1_
